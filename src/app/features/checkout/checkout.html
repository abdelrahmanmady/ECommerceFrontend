<main class="main">

  <!-- Page Title -->
  <div class="page-title light-background">
    <div class="container d-lg-flex justify-content-between align-items-center">
      <h1 class="mb-2 mb-lg-0">Checkout</h1>
      <nav class="breadcrumbs">
        <ol>
          <li><a routerLink="/home">Home</a></li>
          <li class="current">Checkout</li>
        </ol>
      </nav>
    </div>
  </div><!-- End Page Title -->

  <!-- Checkout Section -->
  <section id="checkout" class="checkout section">

    <div class="container" data-aos="fade-up" data-aos-delay="100">

      <div class="row">
        <div class="col-lg-7">
          <!-- Checkout Form -->
          <div class="checkout-container" data-aos="fade-up">
            <form class="checkout-form">
              <!-- Shipping Address -->
              <div class="checkout-section" id="shipping-address">
                <div class="section-header">
                  <div class="section-number">1</div>
                  <h3>Shipping Address</h3>
                </div>
                <div class="section-content">
                  <!-- Default Address Display -->
                  <div class="default-address-display" id="defaultAddressDisplay">
                    <div class="selected-address-card">
                      <div class="address-card-header">
                        <div class="header-left">
                          <i class="bi bi-geo-alt-fill"></i>
                          <span class="address-label">{{currentAddress.label}}</span>
                          <span class="default-badge" *ngIf="currentAddress.isDefault">Default</span>
                        </div>
                        <div class="header-actions">
                          <button type="button" class="btn-change-address me-2" data-bs-toggle="modal"
                            data-bs-target="#addressModal">
                            <i class="bi bi-plus-lg me-1"></i> Add New
                          </button>
                          <button type="button" class="btn-change-address" data-bs-toggle="collapse"
                            data-bs-target="#otherAddressesContainer" aria-expanded="false"
                            aria-controls="otherAddressesContainer">
                            <i class="bi bi-pencil me-1"></i> Change
                          </button>
                        </div>
                      </div>
                      <div class="address-card-body">
                        <p class="address-name">{{currentAddress.name}}</p>
                        <p class="address-text">{{currentAddress.text}}</p>
                        <p class="address-phone"><i class="bi bi-telephone"></i> {{currentAddress.phone}}</p>
                      </div>
                    </div>
                  </div>

                  <!-- Other Saved Addresses (collapsible) -->
                  <div class="collapse" id="otherAddressesContainer">
                    <div class="saved-addresses-container" id="savedAddressesContainer">
                      <h6 class="saved-addresses-title mb-3">
                        <i class="bi bi-geo-alt me-2"></i>Choose a Different Address
                      </h6>
                      <div class="saved-addresses-grid">
                        <!-- Saved Address Item -->
                        <div class="saved-address-card" *ngFor="let address of addresses"
                          [class.selected]="tempSelectedAddress.id === address.id" (click)="selectAddress(address)">
                          <input type="radio" name="savedAddress" [id]="'address' + address.id"
                            [checked]="tempSelectedAddress.id === address.id" class="address-radio">
                          <label [for]="'address' + address.id" class="address-card-content">
                            <div class="address-card-header">
                              <span class="address-label">{{address.label}}</span>
                              <span class="default-badge" *ngIf="address.isDefault">Default</span>
                            </div>
                            <div class="address-card-body">
                              <p class="address-name"><i class="bi bi-person"></i> {{address.name}}</p>
                              <p class="address-text">{{address.text}}</p>
                              <p class="address-phone"><i class="bi bi-telephone"></i> {{address.phone}}</p>
                            </div>
                          </label>
                        </div>
                      </div>

                      <!-- Save Button -->
                      <div class="d-flex justify-content-end mt-4">
                        <button type="button" class="btn btn-save-address" (click)="saveSelectedAddress()">
                          <i class="bi bi-check-lg me-2"></i>Save Selection
                        </button>
                      </div>

                    </div>
                  </div>

                </div>
              </div>

              <!-- Payment Method -->
              <div class="checkout-section" id="payment-method">
                <div class="section-header">
                  <div class="section-number">2</div>
                  <h3>Payment Method</h3>
                </div>
                <div class="section-content">
                  <div class="payment-options">
                    <div class="payment-option" [class.active]="selectedPaymentMethod === 'stripe'"
                      (click)="setPaymentMethod('stripe')">
                      <input type="radio" name="payment-method" id="credit-card"
                        [checked]="selectedPaymentMethod === 'stripe'">
                      <label for="credit-card">
                        <span class="payment-icon"><i class="bi bi-credit-card-2-front"></i></span>
                        <span class="payment-label">Credit / Debit Card (Stripe)</span>
                      </label>
                    </div>
                    <div class="payment-option" [class.active]="selectedPaymentMethod === 'cod'"
                      (click)="setPaymentMethod('cod')">
                      <input type="radio" name="payment-method" id="cod" [checked]="selectedPaymentMethod === 'cod'">
                      <label for="cod">
                        <span class="payment-icon"><i class="bi bi-cash-stack"></i></span>
                        <span class="payment-label">Cash on Delivery</span>
                      </label>
                    </div>
                  </div>

                  <div class="payment-details" id="credit-card-details" *ngIf="selectedPaymentMethod === 'stripe'">
                    <div class="form-group">
                      <label for="card-number">Card Number</label>
                      <div class="card-number-wrapper">
                        <input type="text" class="form-control" name="card-number" id="card-number"
                          placeholder="1234 5678 9012 3456" required="">
                        <div class="card-icons">
                          <i class="bi bi-credit-card-2-front"></i>
                          <i class="bi bi-credit-card"></i>
                        </div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6 form-group">
                        <label for="expiry">Expiration Date</label>
                        <input type="text" class="form-control" name="expiry" id="expiry" placeholder="MM/YY"
                          required="">
                      </div>
                      <div class="col-md-6 form-group">
                        <label for="cvv">Security Code (CVV)</label>
                        <div class="cvv-wrapper">
                          <input type="text" class="form-control" name="cvv" id="cvv" placeholder="123" required="">
                          <span class="cvv-hint" data-bs-toggle="tooltip" data-bs-placement="top"
                            title="3-digit code on the back of your card">
                            <i class="bi bi-question-circle"></i>
                          </span>
                        </div>
                      </div>
                    </div>
                    <div class="form-group">
                      <label for="card-name">Name on Card</label>
                      <input type="text" class="form-control" name="card-name" id="card-name" placeholder="John Doe"
                        required="">
                    </div>
                  </div>

                  <div class="payment-details" id="cod-details" *ngIf="selectedPaymentMethod === 'cod'">
                    <div class="alert alert-info d-flex align-items-center mb-0" role="alert">
                      <i class="bi bi-info-circle-fill me-2 fs-5"></i>
                      <div>
                        You can pay in cash when your order is delivered. Please make sure to have the exact amount
                        ready.
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Order Review -->
              <div class="checkout-section" id="order-review">
                <div class="section-header">
                  <div class="section-number">3</div>
                  <h3>Review &amp; Place Order</h3>
                </div>
                <div class="section-content">
                  <div class="form-check terms-check">
                    <input class="form-check-input" type="checkbox" id="terms" name="terms" required="">
                    <label class="form-check-label" for="terms">
                      I agree to the <a routerLink="/tos" data-bs-toggle="modal" data-bs-target="#termsModal">Terms and
                        Conditions</a> and <a routerLink="/privacy" data-bs-toggle="modal"
                        data-bs-target="#privacyModal">Privacy Policy</a>
                    </label>
                  </div>
                  <div class="success-message d-none">Your order has been placed successfully! Thank you for your
                    purchase.</div>
                  <div class="place-order-container">
                    <button type="submit" class="btn btn-primary place-order-btn">
                      <span class="btn-text">Place Order</span>
                      <span class="btn-price">240.96 <span class="currency-suffix">EGP</span></span>
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>

        <div class="col-lg-5">
          <!-- Order Summary -->
          <div class="order-summary" data-aos="fade-left" data-aos-delay="200">
            <div class="order-summary-header">
              <h3>Order Summary</h3>
              <span class="item-count">2 Items</span>
            </div>

            <div class="order-summary-content">
              <div class="order-items">
                <div class="order-item d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <div class="order-item-image me-3">
                      <img src="assets/img/product/product-1.webp" alt="Product" class="img-fluid">
                    </div>
                    <div class="order-item-details">
                      <h4 class="mb-2">Lorem Ipsum Dolor</h4>
                      <div class="order-item-price">
                        <span class="quantity">1 ×</span>
                        <span class="price">89.99 <span class="currency-suffix">EGP</span></span>
                      </div>
                    </div>
                  </div>
                  <div class="order-item-total fw-bold text-end">
                    <span>89.99 <span class="currency-suffix">EGP</span></span>
                  </div>
                </div>

                <div class="order-item d-flex justify-content-between align-items-center">
                  <div class="d-flex align-items-center">
                    <div class="order-item-image me-3">
                      <img src="assets/img/product/product-2.webp" alt="Product" class="img-fluid">
                    </div>
                    <div class="order-item-details">
                      <h4 class="mb-2">Sit Amet Consectetur</h4>
                      <div class="order-item-price">
                        <span class="quantity">2 ×</span>
                        <span class="price">59.99 <span class="currency-suffix">EGP</span></span>
                      </div>
                    </div>
                  </div>
                  <div class="order-item-total fw-bold text-end">
                    <span>119.98 <span class="currency-suffix">EGP</span></span>
                  </div>
                </div>
              </div>



              <div class="estimated-arrival">
                <div class="arrival-icon">
                  <i class="bi bi-truck"></i>
                </div>
                <div class="arrival-content">
                  <span class="arrival-label">Estimated Delivery</span>
                  <span class="arrival-date">Thu, Feb 22 - Sat, Feb 24</span>
                </div>
              </div>

              <div class="order-totals">
                <div class="order-subtotal d-flex justify-content-between">
                  <span>Subtotal</span>
                  <span>209.97 <span class="currency-suffix">EGP</span></span>
                </div>
                <div class="order-shipping d-flex justify-content-between">
                  <span>Shipping</span>
                  <span>9.99 <span class="currency-suffix">EGP</span></span>
                </div>
                <div class="order-tax d-flex justify-content-between">
                  <span>Tax</span>
                  <span>21.00 <span class="currency-suffix">EGP</span></span>
                </div>
                <div class="order-total d-flex justify-content-between">
                  <span>Total</span>
                  <span>240.96 <span class="currency-suffix">EGP</span></span>
                </div>
              </div>

              <div class="secure-checkout">
                <div class="secure-checkout-header">
                  <i class="bi bi-shield-lock"></i>
                  <span>Secure Checkout</span>
                </div>
                <div class="payment-icons">
                  <i class="bi bi-credit-card-2-front"></i>
                  <i class="bi bi-credit-card"></i>
                  <i class="bi bi-stripe"></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Terms and Privacy Modals -->
      <div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="termsModalLabel">Terms and Conditions</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu
                sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla
                enim. Phasellus molestie magna non est bibendum non venenatis nisl tempor.</p>
              <p>Suspendisse in orci enim. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus
                rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non
                venenatis nisl tempor.</p>
              <p>Suspendisse in orci enim. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus
                rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non
                venenatis nisl tempor.</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
            </div>
          </div>
        </div>
      </div>

      <div class="modal fade" id="privacyModal" tabindex="-1" aria-labelledby="privacyModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-scrollable">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="privacyModalLabel">Privacy Policy</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam in dui mauris. Vivamus hendrerit arcu
                sed erat molestie vehicula. Sed auctor neque eu tellus rhoncus ut eleifend nibh porttitor. Ut in nulla
                enim.</p>
              <p>Suspendisse in orci enim. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus
                rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non
                venenatis nisl tempor.</p>
              <p>Suspendisse in orci enim. Vivamus hendrerit arcu sed erat molestie vehicula. Sed auctor neque eu tellus
                rhoncus ut eleifend nibh porttitor. Ut in nulla enim. Phasellus molestie magna non est bibendum non
                venenatis nisl tempor.</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-primary" data-bs-dismiss="modal">I Understand</button>
            </div>
          </div>
        </div>
      </div>

    </div>

  </section><!-- /Checkout Section -->

  <!-- Address Modal -->
  <div class="modal fade" id="addressModal" tabindex="-1" aria-labelledby="addressModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addressModalLabel">
            <i class="bi bi-geo-alt me-2"></i>
            Add New Address
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="addressForm" class="address-form">
            <div class="form-group mb-3">
              <label for="addressLabel" class="form-label">Address Label *</label>
              <input type="text" class="form-control" id="modalAddressLabel" placeholder="e.g., Home, Office, etc."
                required>
            </div>

            <div class="row">
              <div class="col-md-6 form-group mb-3">
                <label for="fullName" class="form-label">Full Name *</label>
                <input type="text" class="form-control" id="modalFullName" placeholder="Your full name" required>
              </div>
              <div class="col-md-6 form-group mb-3">
                <label for="phoneNumber" class="form-label">Phone Number *</label>
                <input type="tel" class="form-control" id="modalPhoneNumber" placeholder="+20 1012 345 678" required>
              </div>
            </div>

            <div class="form-group mb-3">
              <label for="streetAddress" class="form-label">Street Address *</label>
              <input type="text" class="form-control" id="modalStreetAddress" placeholder="Street name and number"
                required>
            </div>

            <div class="form-group mb-3">
              <label for="apartment" class="form-label">Apartment, Suite, etc. (optional)</label>
              <input type="text" class="form-control" id="modalApartment"
                placeholder="Apartment, Suite, Unit, Building, Floor">
            </div>

            <div class="row">
              <div class="col-md-4 form-group mb-3">
                <label for="city" class="form-label">City *</label>
                <input type="text" class="form-control" id="modalCity" placeholder="City" required>
              </div>
              <div class="col-md-4 form-group mb-3">
                <label for="state" class="form-label">State/Governorate *</label>
                <input type="text" class="form-control" id="modalState" placeholder="State" required>
              </div>
              <div class="col-md-4 form-group mb-3">
                <label for="postalCode" class="form-label">Postal Code</label>
                <input type="text" class="form-control" id="modalPostalCode" placeholder="12345">
              </div>
            </div>

            <div class="form-group mb-3">
              <label for="country" class="form-label">Country *</label>
              <select class="form-select" id="modalCountry" required>
                <option value="" disabled selected>Select Country</option>
                <option value="EG">Egypt</option>
                <option value="SA">Saudi Arabia</option>
                <option value="AE">United Arab Emirates</option>
                <option value="US">United States</option>
                <option value="UK">United Kingdom</option>
                <option value="DE">Germany</option>
                <option value="FR">France</option>
              </select>
            </div>


          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary">
            <i class="bi bi-check-lg me-1"></i>
            Use This Address
          </button>
        </div>
      </div>
    </div>
  </div>

</main>