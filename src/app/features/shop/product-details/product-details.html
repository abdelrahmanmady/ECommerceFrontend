<main class="main">

  <!-- Page Title -->
  <div class="page-title light-background">
    <div class="container d-lg-flex justify-content-between align-items-center">
      <h1 class="mb-2 mb-lg-0">Product Details</h1>
      <nav class="breadcrumbs">
        <ol>
          <li><a routerLink="/home">Home</a></li>
          <li class="current">Product Details</li>
        </ol>
      </nav>
    </div>
  </div><!-- End Page Title -->

  <!-- Product Details Section -->
  <section id="product-details" class="product-details section">

    <div class="container" data-aos="fade-up" data-aos-delay="100">

      <div class="row g-4">
        <!-- Product Gallery -->
        <!-- Product Gallery -->
        <div class="col-lg-7" data-aos="zoom-in" data-aos-delay="150">
          <div class="product-gallery">
            <div class="main-showcase">
              <div class="image-zoom-container">
                @if(mainImage() && mainImage().imageUrl){
                <img [src]="mainImage().imageUrl" alt="Product Main" class="img-fluid main-product-image drift-zoom"
                  id="main-product-image">
                }
                <div class="image-navigation">
                  <button class="nav-arrow prev-image image-nav-btn prev-image" type="button" (click)="prevImage()">
                    <i class="bi bi-chevron-left"></i>
                  </button>
                  <button class="nav-arrow next-image image-nav-btn next-image" type="button" (click)="nextImage()">
                    <i class="bi bi-chevron-right"></i>
                  </button>
                </div>
              </div>
            </div>

            <div class="thumbnail-grid">
              @if(productData()){
              @for(img of productData()!.images; track $index){
              <div class="thumbnail-wrapper thumbnail-item {{$index === activeImage()?'active':''}}"
                (click)="selectImage($index)">
                <img [src]="img.imageUrl" [alt]="'View ' + ($index + 1)" class="img-fluid">
              </div>
              }
              }
            </div>
          </div>
        </div>

        <!-- Product Details -->
        <div class="col-lg-5" data-aos="fade-left" data-aos-delay="200">
          <div class="product-details">
            <div class="product-badge-container">
              @if(productData()){
              <a class="brand-badge" routerLink="/products" [queryParams]="{brandIds: productData()!.brandId}"
                [title]="'View all ' + productData()!.brandName + ' products'">
                <span class="brand-label">Brand</span>
                <span class="brand-name">{{productData()!.brandName}}</span>
              </a>
              }
              <div class="rating-group">
                <div class="stars">
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-fill"></i>
                  <i class="bi bi-star-half"></i>
                </div>
                <span class="review-text">(127 reviews)</span>
              </div>
            </div>

            <h1 class="product-name">{{productData()?.name}}</h1>

            <div class="pricing-section">
              <div class="price-display">
                <span class="price">
                  {{productData()?.price | number : '1.2-2'}}<span class="currency-suffix">EGP</span>
                </span>
              </div>
            </div>

            <div class="product-description">
              @if(productData()?.description) {
              <p>{{productData()?.description}}</p>
              } @else {
              <p class="text-muted fst-italic"><small>No description available for this product.</small></p>
              }
            </div>

            <div class="availability-status">
              @if(productData() && productData()!.stockQuantity > 0){
              <div class="stock-indicator">
                <i class="bi bi-check-circle-fill"></i>
                <span class="stock-text">In Stock</span>
              </div>
              <div class="quantity-left">Only {{productData()!.stockQuantity}} items remaining</div>
              } @else {
              <div class="stock-indicator out-of-stock" style="color: #dc3545;">
                <i class="bi bi-x-circle-fill"></i>
                <span class="stock-text">Out of Stock</span>
              </div>
              }
            </div>

            <!-- Product Variants -->
            <div class="variant-section">
              <div class="size-selection">
                <label class="variant-label">Select Size:</label>
                <div class="size-grid">
                  @for (size of sizes(); track $index) {
                  <button class="size-btn" [class.active]="selectedSize() === size.name"
                    [class.disabled]="!size.available" [disabled]="!size.available" (click)="selectSize(size.name)">
                    {{size.name}}
                  </button>
                  }
                </div>
                <!-- Optional: Show selected size text -->
                @if(selectedSize()) {
                <div class="selected-variant">Selected: <span>{{selectedSize()}}</span></div>
                }
              </div>
            </div>

            <!-- Purchase Options -->
            <div class="purchase-section">
              <div class="quantity-control">
                <label class="control-label">Quantity:</label>
                <div class="quantity-input-group">
                  <div class="quantity-selector" [class.shake]="isShaking()">
                    <button class="quantity-btn decrease" (click)="decreaseQty()" type="button">
                      <i class="bi bi-dash"></i>
                    </button>
                    <input type="number" class="quantity-input" id="quantity" value={{quantity}} min="1"
                      [max]="maxStock" readonly>
                    <button class="quantity-btn increase" (click)="increaseQty()" type="button">
                      <i class="bi bi-plus"></i>
                    </button>
                  </div>
                </div>
              </div>

              <div class="action-buttons">
                <button class="btn primary-action" (click)="addToCart()">
                  <i class="bi bi-bag-plus"></i>
                  Add to Cart
                </button>
                <button class="btn secondary-action">
                  <i class="bi bi-lightning"></i>
                  Buy Now
                </button>
                <button class="btn icon-action" title="Add to Wishlist">
                  <i class="bi bi-heart"></i>
                </button>
              </div>
            </div>

            <!-- Benefits List -->
            <div class="benefits-list">
              <div class="benefit-item">
                <i class="bi bi-truck"></i>
                <span>Free delivery on orders over 1000 EGP</span>
              </div>
              <div class="benefit-item">
                <i class="bi bi-arrow-clockwise"></i>
                <span>45-day hassle-free returns</span>
              </div>
              <div class="benefit-item">
                <i class="bi bi-shield-check"></i>
                <span>3-year manufacturer warranty</span>
              </div>
              <div class="benefit-item">
                <i class="bi bi-headset"></i>
                <span>24/7 customer support available</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Information Tabs -->
      <div class="row mt-5" data-aos="fade-up" data-aos-delay="300">
        <div class="col-12">
          <div class="info-tabs-container">
            <nav class="tabs-navigation nav">
              <button class="nav-link active" data-bs-toggle="tab"
                data-bs-target="#ecommerce-product-details-5-overview" type="button">Overview</button>
              <button class="nav-link" data-bs-toggle="tab"
                data-bs-target="#ecommerce-product-details-5-customer-reviews" type="button">Reviews (127)</button>
            </nav>

            <div class="tab-content">
              <!-- Overview Tab -->
              <div class="tab-pane fade show active" id="ecommerce-product-details-5-overview">
                <div class="overview-content">
                  <div class="row g-4">
                    <div class="col-lg-8">
                      <div class="content-section">
                        <h3>Designed for Performance</h3>
                        <p>
                          Elevate your everyday style with the Nike Performance Polo. Crafted for the modern urban
                          explorer, this polo combines athletic heritage with contemporary street style.
                          Whether you're hitting the golf course or the city streets, the breathable fabric keeps you
                          cool and comfortable all day long.
                        </p>

                        <h4 class="mt-4 mb-3">Material & Care</h4>
                        <div class="material-care-grid">
                          <div class="care-item">
                            <i class="bi bi-droplet"></i>
                            <span>Moisture Wicking</span>
                          </div>
                          <div class="care-item">
                            <i class="bi bi-bootstrap-reboot"></i>
                            <span>Machine Wash Cold</span>
                          </div>
                          <div class="care-item">
                            <i class="bi bi-sun"></i>
                            <span>Do Not Bleach</span>
                          </div>
                          <div class="care-item">
                            <i class="bi bi-wind"></i>
                            <span>Tumble Dry Low</span>
                          </div>
                        </div>

                        <h4 class="mt-4 mb-3">Key Features</h4>
                        <ul class="features-list">
                          <li><i class="bi bi-check2-circle"></i> Dri-FIT technology moves sweat away from your skin.
                          </li>
                          <li><i class="bi bi-check2-circle"></i> Standard fit for a relaxed, easy feel.</li>
                          <li><i class="bi bi-check2-circle"></i> 2-button placket lets you adjust your fit.</li>
                          <li><i class="bi bi-check2-circle"></i> Side vents allow for ease of motion.</li>
                        </ul>
                      </div>
                    </div>

                    <div class="col-lg-4">
                      <div class="size-fit-container">
                        <div class="size-fit-section mb-4">
                          <h4>Size & Fit</h4>
                          <ul class="fit-details">
                            <li><strong>Fit:</strong> Standard Fit</li>
                            <li><strong>Length:</strong> Regular</li>
                            <li><strong>Model:</strong> 185cm (6'1") / Wearing Size L</li>
                          </ul>
                        </div>

                        <div class="composition-section">
                          <h4>Composition</h4>
                          <p class="composition-text">100% Recycled Polyester</p>
                          <div class="fabric-badge">
                            <i class="bi bi-recycle"></i> Sustainable Material
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Reviews Tab -->
              <div class="tab-pane fade" id="ecommerce-product-details-5-customer-reviews">
                <div class="reviews-content">
                  <div class="reviews-header">
                    <div class="rating-overview">
                      <div class="average-score">
                        <div class="score-display">4.6</div>
                        <div class="score-stars">
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-fill"></i>
                          <i class="bi bi-star-half"></i>
                        </div>
                        <div class="total-reviews">127 customer reviews</div>
                      </div>

                      <div class="rating-distribution">
                        <div class="rating-row">
                          <span class="stars-label">5★</span>
                          <div class="progress-container">
                            <div class="progress-fill" style="width: 68%;"></div>
                          </div>
                          <span class="count-label">86</span>
                        </div>
                        <div class="rating-row">
                          <span class="stars-label">4★</span>
                          <div class="progress-container">
                            <div class="progress-fill" style="width: 22%;"></div>
                          </div>
                          <span class="count-label">28</span>
                        </div>
                        <div class="rating-row">
                          <span class="stars-label">3★</span>
                          <div class="progress-container">
                            <div class="progress-fill" style="width: 6%;"></div>
                          </div>
                          <span class="count-label">8</span>
                        </div>
                        <div class="rating-row">
                          <span class="stars-label">2★</span>
                          <div class="progress-container">
                            <div class="progress-fill" style="width: 3%;"></div>
                          </div>
                          <span class="count-label">4</span>
                        </div>
                        <div class="rating-row">
                          <span class="stars-label">1★</span>
                          <div class="progress-container">
                            <div class="progress-fill" style="width: 1%;"></div>
                          </div>
                          <span class="count-label">1</span>
                        </div>
                      </div>
                    </div>

                    <div class="write-review-cta">
                      <h4>Share Your Experience</h4>
                      <p>Help others make informed decisions</p>
                      <button class="btn review-btn">Write Review</button>
                    </div>
                  </div>

                  <div class="customer-reviews-list">
                    <div class="review-card">
                      <div class="reviewer-profile">
                        <img src="assets/img/person/person-f-3.webp" alt="Customer" class="profile-pic">
                        <div class="profile-details">
                          <div class="customer-name">Sarah Martinez</div>
                          <div class="review-meta">
                            <div class="review-stars">
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                            </div>
                            <span class="review-date">March 28, 2024</span>
                          </div>
                        </div>
                      </div>
                      <h5 class="review-headline">Outstanding audio quality and comfort</h5>
                      <div class="review-text">
                        <p>Sed ut perspiciatis unde omnis iste natus error sit voluptatem accusantium doloremque
                          laudantium, totam rem aperiam. Eaque ipsa quae ab illo inventore veritatis et quasi architecto
                          beatae vitae dicta sunt explicabo.</p>
                      </div>
                      <div class="review-actions">
                        <button class="action-btn"><i class="bi bi-hand-thumbs-up"></i> Helpful (12)</button>
                        <button class="action-btn"><i class="bi bi-chat-dots"></i> Reply</button>
                      </div>
                    </div>

                    <div class="review-card">
                      <div class="reviewer-profile">
                        <img src="assets/img/person/person-m-5.webp" alt="Customer" class="profile-pic">
                        <div class="profile-details">
                          <div class="customer-name">David Chen</div>
                          <div class="review-meta">
                            <div class="review-stars">
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star"></i>
                            </div>
                            <span class="review-date">March 15, 2024</span>
                          </div>
                        </div>
                      </div>
                      <h5 class="review-headline">Great value, minor connectivity issues</h5>
                      <div class="review-text">
                        <p>Nemo enim ipsam voluptatem quia voluptas sit aspernatur aut odit aut fugit, sed quia
                          consequuntur magni dolores eos qui ratione voluptatem sequi nesciunt. Overall satisfied with
                          the purchase.</p>
                      </div>
                      <div class="review-actions">
                        <button class="action-btn"><i class="bi bi-hand-thumbs-up"></i> Helpful (8)</button>
                        <button class="action-btn"><i class="bi bi-chat-dots"></i> Reply</button>
                      </div>
                    </div>

                    <div class="review-card">
                      <div class="reviewer-profile">
                        <img src="assets/img/person/person-f-7.webp" alt="Customer" class="profile-pic">
                        <div class="profile-details">
                          <div class="customer-name">Emily Rodriguez</div>
                          <div class="review-meta">
                            <div class="review-stars">
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                              <i class="bi bi-star-fill"></i>
                            </div>
                            <span class="review-date">February 22, 2024</span>
                          </div>
                        </div>
                      </div>
                      <h5 class="review-headline">Perfect for work-from-home setup</h5>
                      <div class="review-text">
                        <p>At vero eos et accusamus et iusto odio dignissimos ducimus qui blanditiis praesentium
                          voluptatum deleniti atque corrupti quos dolores et quas molestias excepturi sint occaecati
                          cupiditate non provident.</p>
                      </div>
                      <div class="review-actions">
                        <button class="action-btn"><i class="bi bi-hand-thumbs-up"></i> Helpful (15)</button>
                        <button class="action-btn"><i class="bi bi-chat-dots"></i> Reply</button>
                      </div>
                    </div>

                    <div class="load-more-section">
                      <button class="btn load-more-reviews">Show More Reviews</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section><!-- /Product Details Section -->

</main>